name: Daily Task Email Reminders

on:
  schedule:
    # Check for upcoming tasks every 5 minutes
    - cron: '*/5 * * * *'
  
  # Allow manual triggering for testing
  workflow_dispatch:

jobs:
  send-email-reminder:
    runs-on: ubuntu-latest
    
    steps:
      - name: Send Task Reminder Email
        run: |
          # Get your Vercel deployment URL - Update this to your actual domain
          VERCEL_URL="https://stanleyhi.com"
          
          # Call the task reminder API
          response=$(curl -s -w "%{http_code}" "$VERCEL_URL/api/task-reminder")
          http_code="${response: -3}"
          response_body="${response%???}"
          
          echo "HTTP Status: $http_code"
          echo "Response: $response_body"
          
          # Check if the request was successful
          if [ "$http_code" -eq 200 ]; then
            echo "✅ Email reminder sent successfully"
          else
            echo "❌ Failed to send email reminder"
            echo "Response: $response_body"
            exit 1
          fi